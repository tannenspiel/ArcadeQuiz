# Руководство по отладке и диагностике ArcadeQuiz

**Версия:** 1.0
**Дата создания:** 2025-01-27
**Статус:** Актуален

---

## Введение

Этот документ описывает инструменты и методы отладки проекта ArcadeQuiz.

## Инструменты отладки

### 1. Debug Overlay (UI)

В проекте реализован мощный визуальный инструмент отладки — `DebugOverlay`.
Подробное описание: [DEBUG_OVERLAY.md](DEBUG_OVERLAY.md)

**Включение:**
Установите в `.env`:
```env
VITE_DEBUG_UI_ENABLED=true
```

**Функционал:**
- Визуализация матрицы спавна (зеленые/красные/синие квадраты).
- Отображение координат игрока и камеры.
- Статистика объектов (враги, ключи).

### 2. Tiled Map Debugging

Для отладки уровней Tiled Map:

1.  **Визуализация коллизий:**
    В `MainScene` можно включить отрисовку физических тел:
    ```typescript
    physics: {
        default: 'arcade',
        arcade: {
            debug: true // Включить для просмотра границ тел
        }
    }
    ```

2.  **Overlap Mask (GID 12):**
    Используйте `DebugOverlay` для проверки, где система видит "постоянные" объекты. Зоны входа в порталы должны быть помечены как занятые (красные в матрице), если они экспортируются как collidable, или визуально проверяться через Debug Graphics физики.

### 3. VS Code Debugging

Для отладки кода (брейкпоинты):
1.  Установите расширение "Debugger for Chrome/Firefox".
2.  Запустите конфигурацию "Debug Client" (если настроена в `.vscode/launch.json`).

## Типичные проблемы и решения

### Проблемы с коллизиями в Tiled Map
- **Симптомы:** Игрок проходит сквозь стены или не может войти в портал.
- **Диагностика:**
    - Включите `physics.arcade.debug: true`.
    - Проверьте, что тайлы стен находятся в слое "Collision Mask".
    - Для порталов: убедитесь, что физическое тело "сенсора" достаточно расширено (см. `COLLISION_CONFIG.TILED_SENSOR_EXPANSION` в `gameConstants.ts`).

### Проблемы спавна
- **Симптомы:** Враги или предметы не появляются.
- **Диагностика:**
    - Включите `VITE_DEBUG_UI_ENABLED=true`.
    - Посмотрите на счетчики "Failed Spawns" в оверлее.
    - Красные зоны в матрице показывают занятые места.

## Логирование

В проекте используются `console.log` с префиксами для важных событий:
- `Setup:` — инициализация систем.
- `Spawn:` — события спавна.
- `Tiled:` — загрузка и обработка карты.

---

**Связанные документы:**
- [DEBUG_OVERLAY.md](DEBUG_OVERLAY.md)
- [TESTING.md](TESTING.md)
