# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ ArcadeQuiz

**–í–µ—Ä—Å–∏—è:** 3.0
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-26
**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2026-02-07

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ v3.0:**
- ‚úÖ **SCORE SYSTEM v3:** –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—á–∫–æ–≤ —Å –Ω–∞–≥—Ä–∞–¥–∞–º–∏ –∏ —à—Ç—Ä–∞—Ñ–∞–º–∏
  - –ö–ª—é—á–∏: +5 (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π), +2 (–ø–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è) –≤–º–µ—Å—Ç–æ +1
  - –ú–æ–Ω–µ—Ç–∫–∏: +5 (—É–Ω–∏–∫–∞–ª—å–Ω–∞—è), +2 (–ø–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è)
  - –®—Ç—Ä–∞—Ñ—ã: -2 (—É—Ä–æ–Ω), -3 (–æ—à–∏–±–∫–∞ –∫–≤–∏–∑–∞), -10 (–æ—à–∏–±–∫–∞ –ø–æ—Ä—Ç–∞–ª–∞)
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—á–∫–æ–≤ (–º–∏–Ω–∏–º—É–º = 0)
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –º–æ–Ω–µ—Ç–æ–∫ —á–µ—Ä–µ–∑ answeredCoinStatements
- ‚úÖ **ADAPTIVE MODALS:** –°–∏—Å—Ç–µ–º–∞ 7 –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ aspect ratio (–≤–º–µ—Å—Ç–æ –±–∏–Ω–∞—Ä–Ω–æ–π portrait/landscape)
  - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏ —à—Ä–∏—Ñ—Ç–æ–≤: 1.26‚Äì1.54
  - –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ KeyQuestionModal –∏ CoinBubbleQuiz
- ‚úÖ **LOCALIZATION:** –ü–æ–ª–Ω–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è UI (–°—á—ë—Ç, –ò–ì–†–ê–¢–¨ –ó–ê–ù–û–í–û, –°–õ–ï–î–£–Æ–©–ò–ô –£–†–û–í–ï–ù–¨, –í–û–ô–¢–ò –í –ü–û–†–¢–ê–õ, –û–¢–ú–ï–ù–ê)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ v2.5:**
- ‚úÖ **HYBRID LOADING:** –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∑–∞–≥—Ä—É–∑–∫–∏ (DOM + Phaser).
- ‚úÖ **PERFORMANCE:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è FCP (1.4s) –∏ TBT.
- ‚úÖ **PRODUCTION BUILD:** –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ modulePreload.
- ‚úÖ **DYNAMIC LEVEL SYSTEM:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–≤–Ω–µ–π –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ N —É—Ä–æ–≤–Ω–µ–π.
  - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∞—Å—Å–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ `for (1..MAX_LEVELS)` –≤ LoadingScene
  - Dynamic Asset Keys —á–µ—Ä–µ–∑ `getLevelAssetKey()` –∏ `LevelAssetKeys`
  - LevelManager –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Phaser.Cache –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
  - WorldFactory –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–∏ `getMapBgKey(currentLevel)`
  - MAX_LEVELS —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `gameConstants.ts` (—Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 3)
  - **N-Level Support VERIFIED** - Level 3 —Å–æ–∑–¥–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ v2.3:**
- ‚úÖ **HARDCODE AUDIT:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç (`depths`, `audio paths`) –≤ `gameConstants.ts`.
- ‚úÖ **GRASS FIX:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–æ–Ω–∞ (GrassBackgroundSprite).

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ v2.2:**
- ‚úÖ **UI DYNAMICS:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è HUD.
- ‚úÖ **VISUAL FEEDBACK:** –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –º–æ–Ω–µ—Ç –Ω–∞ —Å–ø—Ä–∞–π—Ç–µ –û—Ä–∞–∫—É–ª–∞.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ v2.1:**
- ‚úÖ **DISTANCE-BASED COLLISIONS:** –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∞–π—Ç–µ–º–æ–≤ (50px).
- ‚úÖ **COIN MECHANIC:** –û–±–Ω–æ–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–∑ –∏–≥—Ä—ã –∏ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø—Ä–µ–¥–º–µ—Ç–æ–≤.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ v1.8:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Tiled Map –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π (A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ Tiled Map —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (TILED_MAP_IMPLEMENTATION.md)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ MainScene —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –¥–≤—É—Ö —Ä–µ–∂–∏–º–æ–≤ —Å–æ–∑–¥–∞–Ω–∏—è –º–∏—Ä–∞

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ v1.7:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –º–∞—Ç—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (SPAWN_MATRIX_SYSTEM.md)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ SpawnSystem —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –º–∞—Ç—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã  
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç—É–∞–ª–µ–Ω

---

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ ArcadeQuiz, –≤–∫–ª—é—á–∞—è –º–æ–¥—É–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞.

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#–æ–±–∑–æ—Ä-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
2. [–°–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#—Å–ª–æ–∏-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
3. [–°–∏—Å—Ç–µ–º–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è](#—Å–∏—Å—Ç–µ–º–∞-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è)
4. [Core –º–æ–¥—É–ª–∏](#core-–º–æ–¥—É–ª–∏)
5. [Entities (–°—É—â–Ω–æ—Å—Ç–∏)](#entities-—Å—É—â–Ω–æ—Å—Ç–∏)
6. [Systems (–°–∏—Å—Ç–µ–º—ã)](#systems-—Å–∏—Å—Ç–µ–º—ã)
7. [Scenes (–°—Ü–µ–Ω—ã)](#scenes-—Å—Ü–µ–Ω—ã)
8. [UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#ui-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
9. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è React-Phaser](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-react-phaser)
10. [–ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#–ø–∞—Ç—Ç–µ—Ä–Ω—ã-–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
11. [–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö](#–ø–æ—Ç–æ–∫–∏-–¥–∞–Ω–Ω—ã—Ö)
12. [Tiled Map —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](#tiled-map-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
13. [–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ (Loading Flow)](#–ø—Ä–æ—Ü–µ—Å—Å-–∑–∞–≥—Ä—É–∑–∫–∏-loading-flow)

---

## –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

- **Performance First:** FCP 1.4s –±–ª–∞–≥–æ–¥–∞—Ä—è –≥–∏–±—Ä–∏–¥–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ (React UI —Å–Ω–∞—á–∞–ª–∞, Phaser –ø–æ—Ç–æ–º).
- **Game Flow:** `COIN` Phase (collect 3 coins, solve bubble quizzes) -> `KEY` Phase (collect 3 keys, solve modal quizzes) -> Portal Activation.
- **Entities:** –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (AbstractItem, AbstractEnemy, AbstractPortal).
- **Interactions:** Distance-based –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∞–π—Ç–µ–º–æ–≤ (`dist < 50px`) –≤–º–µ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –æ–≤–µ—Ä–ª–∞–ø–æ–≤.
ArcadeQuiz –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏. –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏—é Phaser 3 –¥–ª—è –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ –∏ React –¥–ª—è UI, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É —Å–æ–±—ã—Ç–∏–π EventBus.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** ‚Äî –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –æ–±–ª–∞—Å—Ç—å
2. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã
3. **–ú—É–ª—å—Ç–∏-—Ç–µ–º–∞** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–≥—Ä —á–µ—Ä–µ–∑ `CURRENT_THEME`
4. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** ‚Äî –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –≤—Ä–∞–≥–æ–≤/–ø–æ—Ä—Ç–∞–ª–æ–≤
5. **–¢–∏–ø–∏–∑–∞—Ü–∏—è** ‚Äî –ø–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è TypeScript

---

## –°–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         React UI Layer              ‚îÇ
‚îÇ  (UIOverlay, Modals, Components)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ EventBus
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      Phaser Game Layer               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ      Scenes                  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  (BaseScene, MainScene)      ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ             ‚îÇ                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ      Systems                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  (Health, Score, Quiz, etc)  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ             ‚îÇ                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ      Entities                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  (Player, Enemies, Portals)   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ             ‚îÇ                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ      Core                    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  (AssetLoader, GameState)    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –°–∏—Å—Ç–µ–º–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

### –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è** –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–æ–≤.

### –£—Ä–æ–≤–Ω–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ (720√ó1280)**
   - –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –¥–ª—è UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
   - –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω —á–µ—Ä–µ–∑ `Phaser.Scale.FIT`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç letterboxing –ø—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω

2. **–ë–∞–∑–æ–≤–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –º–∏—Ä–∞ (BASE_SCALE = 4.0)**
   - –ö–∞—Ä—Ç–∞: 512√ó512 –±–∞–∑–æ–≤—ã—Ö ‚Üí 2048√ó2048 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π
   - –ê–∫—Ç–æ—Ä—ã: –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `BASE_SCALE √ó ACTOR_SIZES[—Ç–∏–ø]`

### –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã

- **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã UI:** 0-720 –ø–æ X, 0-1280 –ø–æ Y (–¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è UI)
- **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–≥—Ä–æ–≤–æ–≥–æ –º–∏—Ä–∞:** 0-2048 –ø–æ X, 0-2048 –ø–æ Y (–¥–ª—è –∏–≥—Ä–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤)

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

- `src/react/PhaserGame.tsx` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
- `src/constants/gameConstants.ts` - –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (GAME_WIDTH, GAME_HEIGHT, BASE_SCALE, MAP_WIDTH, MAP_HEIGHT)
- `src/game/scenes/BaseScene.ts` - –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–º–µ—Ä—ã –∏ —Ñ–∏–∑–∏–∫–∏
- `src/game/scenes/MainScene.ts` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–º–µ—Ä—ã

### –ö–∞–º–µ—Ä–∞

- **–†–∞–∑–º–µ—Ä –∫–∞–º–µ—Ä—ã:** 720√ó1280 (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞)
- **–ì—Ä–∞–Ω–∏—Ü—ã –∫–∞–º–µ—Ä—ã:** 0-2048 (–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–≥—Ä–æ–≤–æ–≥–æ –º–∏—Ä–∞)
- **–°–ª–µ–¥–æ–≤–∞–Ω–∏–µ:** –∑–∞ –∏–≥—Ä–æ–∫–æ–º —Å –ø–ª–∞–≤–Ω–æ—Å—Ç—å—é (lerp factor 0.15)
- **Zoom:** 1.0 (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è)

### –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –≤–∫–ª—é—á–∞—è –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã, –∫–∞—Ä—Ç—ã –∏ letterboxing, –¥–æ—Å—Ç—É–ø–Ω–æ –≤:
- `documentation/export_llm/SCALING_SYSTEM.md` - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è LLM –∞–Ω–∞–ª–∏–∑–∞

---

## Core –º–æ–¥—É–ª–∏

### AssetLoader

**–ü—É—Ç—å:** `src/game/core/AssetLoader.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–µ –∏–≥—Ä—ã.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `loadImage(key, path)` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `loadAudio(key, path)` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ
- `loadJSON(key, path)` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ JSON —Ñ–∞–π–ª–æ–≤
- `loadLevelQuestions(levelNumber)` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ —É—Ä–æ–≤–Ω—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `CURRENT_THEME` –∏–∑ `gameConfig.ts`
- –ö–µ—à–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç fallback –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```typescript
const assetLoader = new AssetLoader(scene);
await assetLoader.loadImage('heart', '/images/Heart5x5.png');
const heartTexture = scene.textures.get('heart');
```

### LevelManager

**–ü—É—Ç—å:** `src/game/core/LevelManager.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è–º–∏ –∏–≥—Ä—ã, –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é.

**‚úÖ –†–ï–§–ê–ö–¢–û–†–ò–ù–ì (v2.4):** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏–∑ Phaser Cache.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `loadLevelConfig(levelNumber)` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞ —É—Ä–æ–≤–Ω—è –∏–∑ Phaser Cache
- `getCurrentLevelConfig()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞
- `getEnemySpawnConfig()` ‚Äî –∫–æ–Ω—Ñ–∏–≥ —Å–ø–∞–≤–Ω–∞ –≤—Ä–∞–≥–æ–≤
- `getEnemySpeedConfig()` ‚Äî –∫–æ–Ω—Ñ–∏–≥ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—Ä–∞–≥–æ–≤
- `getItemSpawnConfig()` ‚Äî –∫–æ–Ω—Ñ–∏–≥ —Å–ø–∞–≤–Ω–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- `nextLevel()` ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π MAX_LEVELS)
- `getDifficultyMultiplier()` ‚Äî –º–Ω–æ–∂–∏—Ç–µ–ª—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:** –ö–æ–Ω—Ñ–∏–≥–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `AssetLoader.getJSON()` –∏–∑ Phaser Cache
- ‚úÖ **JSON Schema Validation:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ JSON —Å fallback –Ω–∞ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ **N-Level Support:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—Ä–æ–≤–Ω–µ–π —á–µ—Ä–µ–∑ MAX_LEVELS
- ‚úÖ **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ –∫–µ—à–∏—Ä—É—é—Ç—Å—è –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º Map
- **Fallback:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:**
- –ö–æ–Ω—Ñ–∏–≥–∏ —É—Ä–æ–≤–Ω–µ–π: `src/config/levelConfigs/level{N}.config.json`
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ LoadingScene —á–µ—Ä–µ–∑ `dynamic import()` (Vite –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–º–ø–æ—Ä—Ç JSON –∏–∑ src/)

**–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å:**
1. –°–æ–∑–¥–∞—Ç—å `level{N}.config.json` –≤ `src/config/levelConfigs/`
2. –°–æ–∑–¥–∞—Ç—å —Ñ–æ–Ω–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è `src/assets/Game_01/images/Bg.*_Level{N}_512x512.png` (4 —Ñ–∞–π–ª–∞)
3. –°–æ–∑–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã `src/assets/Game_01/questions/level{N}.questions.json` –∏ `level{N}.coin-quiz.json`
4. –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç—É `src/assets/Game_01/level_maps/Level{N}_map.json` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –ò–∑–º–µ–Ω–∏—Ç—å `MAX_LEVELS` –≤ `src/constants/gameConstants.ts`

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```json
{
  "levelNumber": 1,
  "enemySpawn": {
    "initialCount": {
      "randomWalker": 1,
      "chaser": 1,
      "flam": 1
    },
    "periodicSpawnDelay": 6000,
    "maxEnemies": 2,
    "enabledTypes": ["randomWalker", "chaser", "flam"]
  },
  "enemySpeed": {
    "randomWalker": 80,
    "chaser": 30,
    "flam": 60
  },
  "itemSpawn": {
    "hearts": {"initial": 8, "max": 10, "spawnDelay": 24000},
    "keys": {"initial": 15, "max": 15, "spawnDelay": 24000},
    "coins": {"initial": 12, "max": 18, "spawnDelay": 10000}
  },
  "levelConfig": {
    "useTiledMap": false,
    "tiledMapKey": "level1_json",
    "portalSpawnRadius": 720,
    "maxInventoryKeys": 3
  }
}
```

### GameState

**–ü—É—Ç—å:** `src/game/core/GameState.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã, –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∏–∑ –ª—é–±–æ–π —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `getHealth()`, `setHealth(value)` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å–µ–º
- `getKeys()`, `addKey()`, `removeKey()` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏
- `getScore()`, `setScore(value)` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–∫–∞–º–∏
- `getLevel()`, `setLevel(value)` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–º
- `isAltarActivated()`, `setAltarActivated(value)` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–ª—Ç–∞—Ä—è
- `reset()` ‚Äî —Å–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- Singleton –ø–∞—Ç—Ç–µ—Ä–Ω
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É Phaser –∏ React

---

## Entities (–°—É—â–Ω–æ—Å—Ç–∏)

### Player

**–ü—É—Ç—å:** `src/game/entities/Player.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–ª–∞—Å—Å –∏–≥—Ä–æ–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏–µ–º –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `getPosition()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- `getX()`, `getY()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- `stop()` ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–≤–∏–∂–µ–Ω–∏—è –∏ –∞–Ω–∏–º–∞—Ü–∏–∏
- `getSprite()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø—Ä–∞–π—Ç–∞

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞: WASD / —Å—Ç—Ä–µ–ª–∫–∏
- Drag and Move –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –°–∫–æ—Ä–æ—Å—Ç—å: `PLAYER_SPEED = 250` (–∏–∑ `gameConstants.ts`)
- –†–∞–∑–º–µ—Ä: `ACTOR_SIZES.PLAYER = 4.0`
- **Depth:** `6` (–≤—ã—à–µ –ø–æ—Ä—Ç–∞–ª–æ–≤, –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∏ –∫—É—Å—Ç–æ–≤, –Ω–æ –Ω–∏–∂–µ –≤—Ä–∞–≥–æ–≤ –∏ –æ—Ä–∞–∫—É–ª–∞)

### AbstractEnemy

**–ü—É—Ç—å:** `src/game/entities/enemies/AbstractEnemy.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤.

**–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `updateAI(player)` ‚Äî –ª–æ–≥–∏–∫–∞ AI (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –ø–æ–¥–∫–ª–∞—Å—Å–∞—Ö)

**–û–±—â–∏–µ –º–µ—Ç–æ–¥—ã:**
- `update(player)` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–∞–≥–∞
  - ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –ø–∞—É–∑—ã:** –ø—Ä–æ–≤–µ—Ä–∫–∞ `scene.scene.isPaused()` –≤ –Ω–∞—á–∞–ª–µ –º–µ—Ç–æ–¥–∞
  - ‚úÖ –ï—Å–ª–∏ —Å—Ü–µ–Ω–∞ –Ω–∞ –ø–∞—É–∑–µ (–º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ), –≤—Ä–∞–≥ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏ –Ω–µ –∫–ª–æ–Ω–∏—Ä—É–µ—Ç—Å—è
  - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—É–∑—ã —Ç–∞–∫–∂–µ –≤ `handlePlayerDetection()`, `startSpawningAnimation()`, `createClones()` –∏ –≤ callback `delayedCall`
- `onPlayerCollision(player)` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–ª–ª–∏–∑–∏–∏ —Å –∏–≥—Ä–æ–∫–æ–º
- `destroy()` ‚Äî —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –≤—Ä–∞–≥–∞
- `isActive()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–°–≤–æ–π—Å—Ç–≤–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è:**
- `chaseRadius` ‚Äî —Ä–∞–¥–∏—É—Å –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ > 0, –≤—Ä–∞–≥ –ø—Ä–µ—Å–ª–µ–¥—É–µ—Ç –∏–≥—Ä–æ–∫–∞)
- `chaseSpeed` ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ > 0, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ baseSpeed –ø—Ä–∏ –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏)
- `cloneDetectionRadius` ‚Äî —Ä–∞–¥–∏—É—Å –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `cloneCount` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–æ–Ω–æ–≤ –ø—Ä–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏

**–ù–∞—Å–ª–µ–¥–Ω–∏–∫–∏:**
- `EnemyRandomWalker` ‚Äî —Å–ª—É—á–∞–π–Ω–æ–µ –±–ª—É–∂–¥–∞–Ω–∏–µ
- `EnemyChaser` ‚Äî –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ (chaseRadius > 0, chaseSpeed > baseSpeed)
- `EnemyFlam` ‚Äî –∫–ª–æ–Ω–∏—Ä—É—é—â–∏–π –≤—Ä–∞–≥ (cloneDetectionRadius > 0, cloneCount > 0)

### AbstractPortal

**–ü—É—Ç—å:** `src/game/entities/portals/AbstractPortal.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –ø–æ—Ä—Ç–∞–ª–æ–≤.

**–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `onKeyDeposit()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–ø–æ–∑–∏—Ç–∞ –∫–ª—é—á–∞
- `onEnter()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `isCorrect`)

**–û–±—â–∏–µ –º–µ—Ç–æ–¥—ã:**
- `depositKey()` ‚Äî –¥–µ–ø–æ–∑–∏—Ç –∫–ª—é—á–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è 3 –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è)
- `activate()` ‚Äî –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ—Ä—Ç–∞–ª–∞ (–≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –¥–≤–∞ –∑–≤—É–∫–∞: –Ω–∞—á–∞–ª–æ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ)
- `isOpen()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫—Ä—ã—Ç –ª–∏ –ø–æ—Ä—Ç–∞–ª

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–†–∞–∑–º–µ—Ä —Å–ø—Ä–∞–π—Ç–∞:** 64√ó48 –ø–∏–∫—Å–µ–ª–µ–π (–¥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è)
- **–¢–µ–∫—Å—Ç—É—Ä—ã –∏ –∞–Ω–∏–º–∞—Ü–∏–∏:** –í—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Ä—Ç–∞–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–ø—Ä–∞–π—Ç—à–∏—Ç—ã —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏:
  - –ë–∞–∑–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `Portal_X.Base_24F_1536x48.png` (X = A, B, C) - 24 –∫–∞–¥—Ä–∞, 8 fps, —Ü–∏–∫–ª–∏—á–Ω–æ (3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ —Ü–∏–∫–ª)
  - –ê–Ω–∏–º–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: `Portal_X.Activation_24F_1536x48.png` (X = A, B, C) - 24 –∫–∞–¥—Ä–∞, 8 fps, —Ü–∏–∫–ª–∏—á–Ω–æ –≤–æ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ —Ü–∏–∫–ª)
  - –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `Portal_X.Activated_24F_1536x48.png` (X = A, B, C) - 24 –∫–∞–¥—Ä–∞, 8 fps, —Ü–∏–∫–ª–∏—á–Ω–æ (3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ —Ü–∏–∫–ª)
- –í—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—Ä—Ç–∞–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å 8 fps
- –î–ª—è physics —Å–ø—Ä–∞–π—Ç–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ –≤ `MainScene.update()`
- **Depth:** `4` (–≤—ã—à–µ –∫—É—Å—Ç–æ–≤ –∏ —Ç–µ–∫—Å—Ç–æ–≤, –Ω–æ –Ω–∏–∂–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤, –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, –≤—Ä–∞–≥–æ–≤ –∏ –æ—Ä–∞–∫—É–ª–∞)

**–ù–∞—Å–ª–µ–¥–Ω–∏–∫–∏:**
- `StandardPortal` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç–∞–ª

**–°–æ—Å—Ç–æ—è–Ω–∏—è (PortalState):**
- `BASE` ‚Äî –±–∞–∑–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∑–∞–∫—Ä—ã—Ç)
- `INTERACTION` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (–ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏–µ–º–∞ –∫–ª—é—á–∞, –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–≤–æ–¥ 2-–≥–æ –∫–ª—é—á–∞)
- `ACTIVATING` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è)
- `ACTIVATED` ‚Äî –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω (–æ—Ç–∫—Ä—ã—Ç, —Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∞–Ω–∏–º–∞—Ü–∏—è)

**–õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤:**
- `BASE` ‚Üí –ü—Ä–∏ 1-–º/2-–º –∫–ª—é—á–µ ‚Üí `INTERACTION` (–∞–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏–µ–º–∞) ‚Üí `BASE`
- `BASE` ‚Üí –ü—Ä–∏ 3-–º –∫–ª—é—á–µ ‚Üí `ACTIVATING` (–∞–Ω–∏–º–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è) ‚Üí `ACTIVATED`
- `ACTIVATED` ‚Üí –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ú–µ—Ç–æ–¥ `depositKey()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `boolean` (–∑–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ —Å–ø–∏—Å–∞–Ω–∏—è)
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–≤–æ–¥–∞ –≤–æ –≤—Ä–µ–º—è `INTERACTION` –∏ `ACTIVATED`
- –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–π –≤ `MainScene` (fix freezing)

### Oracle

**–ü—É—Ç—å:** `src/game/entities/Oracle.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–ª–∞—Å—Å –æ—Ä–∞–∫—É–ª–∞ —Å —Å–∏—Å—Ç–µ–º–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –∞–Ω–∏–º–∞—Ü–∏–π.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `depositKey()` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á –≤ –æ—Ä–∞–∫—É–ª (–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ACTIVATING)
- `getState()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (OracleState)
- `getStoredKeys()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö—Ä–∞–Ω–∏–º—ã—Ö –∫–ª—é—á–µ–π
- `isActivated()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ª–∏ –æ—Ä–∞–∫—É–ª
- `getSprite()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–ø—Ä–∞–π—Ç
- `reset()` ‚Äî —Å–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ä–∞–∫—É–ª–∞
- `destroy()` ‚Äî —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –æ—Ä–∞–∫—É–ª

**–°–æ—Å—Ç–æ—è–Ω–∏—è:**
- `BASE` ‚Äî –±–∞–∑–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞ `Oracle.Base_32x64.png`)
- `ACTIVATING` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–∞–Ω–∏–º–∞—Ü–∏—è `oracle_activation`, –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∫–ª—é—á–µ)
- `ACTIVATED` ‚Äî –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∞–Ω–∏–º–∞—Ü–∏—è `oracle_activated`, –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è —Ü–∏–∫–ª–∏—á–Ω–æ)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏
- –î–ª—è physics —Å–ø—Ä–∞–π—Ç–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ –≤ `MainScene.update()`
- –ü—Ä–∏ –¥–æ—Å—Ç–∞–≤–∫–µ –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–∞ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è### –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª (Game Loop)

#### 1. –§–∞–∑–∞ –º–æ–Ω–µ—Ç (COIN Phase)
- **–¶–µ–ª—å:** –°–æ–±—Ä–∞—Ç—å 3 –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –º–æ–Ω–µ—Ç—ã.
- **–ú–µ—Ö–∞–Ω–∏–∫–∞:** –ü—Ä–∏ –ø–æ–¥–±–æ—Ä–µ –º–æ–Ω–µ—Ç—ã –ø–æ—è–≤–ª—è–µ—Ç—Å—è `CoinBubbleQuiz`. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ –º–æ–Ω–µ—Ç–∞ –∑–∞—á–∏—Å–ª—è–µ—Ç—Å—è.
- **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∏–≥—Ä–æ–∫ –ø—Ä–∏–Ω–µ—Å–µ—Ç 3 –º–æ–Ω–µ—Ç—ã –û—Ä–∞–∫—É–ª—É, –æ–Ω –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∏ –∏–≥—Ä–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ñ–∞–∑—É –∫–ª—é—á–µ–π.

#### 2. –§–∞–∑–∞ –∫–ª—é—á–µ–π (KEY Phase)
- **–¶–µ–ª—å:** –°–æ–±—Ä–∞—Ç—å 3 –∫–ª—é—á–∞ –∏ –≤–æ–π—Ç–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç–∞–ª.
- **–ú–µ—Ö–∞–Ω–∏–∫–∞:** –ö–ª—é—á–∏ —Å–ø–∞–≤–Ω—è—Ç—Å—è –≤–º–µ—Å—Ç–æ –º–æ–Ω–µ—Ç. –ö–∞–∂–¥—ã–π –∫–ª—é—á —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å –≤ `KeyQuestionModal`.
- **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ—Ä—Ç–∞–ª–∞ (3 –∫–ª—é—á–∞) –∏–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å.

---

### –°—É—â–Ω–æ—Å—Ç–∏ (Entities)

#### –ò–µ—Ä–∞—Ä—Ö–∏—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (Items)
–í—Å–µ –ø–æ–¥–±–∏—Ä–∞–µ–º—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç `AbstractItem`:
- **Coin:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `COIN` —Ñ–∞–∑–µ. –¢—Ä–∏–≥–≥–µ—Ä–∏—Ç `CoinBubbleQuiz`.
- **Key:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `KEY` —Ñ–∞–∑–µ. –¢—Ä–∏–≥–≥–µ—Ä–∏—Ç `KeyQuestionModal`.
- **Heart:** –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.

#### –û—Ä–∞–∫—É–ª (Oracle)
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ñ–∏–≥—É—Ä–∞ —É—Ä–æ–≤–Ω—è. 
- –í `COIN` —Ñ–∞–∑–µ: –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–æ–Ω–µ—Ç—ã. –ü–æ—Å–ª–µ 3-–π –º–æ–Ω–µ—Ç—ã –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è (—Å–æ—Å—Ç–æ—è–Ω–∏–µ `ACTIVATED`), —ç–º–∏—Ç–∏—Ç —Å–æ–±—ã—Ç–∏–µ `ORACLE_ACTIVATED`, –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ—Ä—Ç–∞–ª—ã –≤ —Ä–µ–∂–∏–º –æ–∂–∏–¥–∞–Ω–∏—è –∫–ª—é—á–µ–π.
- –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π `GamePhase` –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `KEY`.
- –ë–∞–∑–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `Oracle.Base_32x64.png` (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞, 32√ó64 –ø–∏–∫—Å–µ–ª–µ–π)
- –ê–Ω–∏–º–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: `Oracle.Activation_16F_512x64.png` (16 –∫–∞–¥—Ä–æ–≤, 32√ó64 –∫–∞–∂–¥—ã–π, 8 FPS, repeat: 0)
- –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `Oracle.Activated_16F_512x64.png` (16 –∫–∞–¥—Ä–æ–≤, 32√ó64 –∫–∞–∂–¥—ã–π, 8 FPS, repeat: -1)
- –í—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å 8 fps
- –ü—Ä–∏ –¥–æ—Å—Ç–∞–≤–∫–µ –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–∞ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (16 –∫–∞–¥—Ä–æ–≤, 2 —Å–µ–∫—É–Ω–¥—ã)
- –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö 3 –∫–ª—é—á–µ–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π (16 –∫–∞–¥—Ä–æ–≤, 2 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ —Ü–∏–∫–ª)
- **Depth:** `8` (—Å–∞–º—ã–π –≤–µ—Ä—Ö–Ω–∏–π —Å–ª–æ–π –∏–≥—Ä–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤, –≤—ã—à–µ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö)
- **–†–∞–∑–º–µ—Ä:** `ACTOR_SIZES.ORACLE = 1.0`

**–¢–µ–∫—Å—Ç—É—Ä—ã –∏ –∞–Ω–∏–º–∞—Ü–∏–∏:**
- –ë–∞–∑–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `Oracle.Base_32x64.png` (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞, 32√ó64 –ø–∏–∫—Å–µ–ª–µ–π)
- –ê–Ω–∏–º–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: `Oracle.Activation_16F_512x64.png` (16 –∫–∞–¥—Ä–æ–≤, 32√ó64 –∫–∞–∂–¥—ã–π, 8 FPS, repeat: 0)
- –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `Oracle.Activated_16F_512x64.png` (16 –∫–∞–¥—Ä–æ–≤, 32√ó64 –∫–∞–∂–¥—ã–π, 8 FPS, repeat: -1)
- –í—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å 8 fps

**–õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤:**
1. –ë–ê–ó–û–í–û–ï ‚Üí –ø—Ä–∏ –¥–æ—Å—Ç–∞–≤–∫–µ –∫–ª—é—á–∞ ‚Üí –ê–ö–¢–ò–í–ê–¶–ò–Ø ‚Üí –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ ‚Üí –ë–ê–ó–û–í–û–ï (–µ—Å–ª–∏ –Ω–µ –≤—Å–µ –∫–ª—é—á–∏) –∏–ª–∏ –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–ù–û–ï (–µ—Å–ª–∏ –≤—Å–µ 3 –∫–ª—é—á–∞)
2. –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–ù–û–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è —Ü–∏–∫–ª–∏—á–Ω–æ –∏ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è

---

## Systems (–°–∏—Å—Ç–µ–º—ã)

### HealthSystem

**–ü—É—Ç—å:** `src/game/systems/HealthSystem.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å–µ–º –∏–≥—Ä–æ–∫–∞.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `takeDamage(amount)` ‚Äî –Ω–∞–Ω–µ—Å—Ç–∏ —É—Ä–æ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `isAlive`
- `heal(amount)` ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ
- `updatePlayerHealthPosition()` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –∑–¥–æ—Ä–æ–≤—å—è –Ω–∞–¥ –∏–≥—Ä–æ–∫–æ–º
- `getHealth()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –∑–¥–æ—Ä–æ–≤—å–µ
- `getMaxHealth()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç PNG —Ç–µ–∫—Å—Ç—É—Ä—É `Heart5x5.png` —Å –º–∞—Å—à—Ç–∞–±–æ–º 4x –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–µ—Ä–¥–µ—á–µ–∫ –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π –∏–≥—Ä–æ–∫–∞
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ –∑–¥–æ—Ä–æ–≤—å–µ–º –∏–º–µ–µ—Ç **depth `6`** (–Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞)
- Fallback —Ç–µ–∫—Å—Ç—É—Ä–∞ –µ—Å–ª–∏ PNG –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω (–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)

### ScoreSystem

**–ü—É—Ç—å:** `src/game/systems/ScoreSystem.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥—Å—á–µ—Ç –æ—á–∫–æ–≤ –∏–≥—Ä–æ–∫–∞ —Å —Å–∏—Å—Ç–µ–º–æ–π –Ω–∞–≥—Ä–∞–¥ –∏ —à—Ç—Ä–∞—Ñ–æ–≤.

**‚úÖ v3 - –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—á–∫–æ–≤:**

**–ù–∞–≥—Ä–∞–¥—ã:**
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á (–≤–ø–µ—Ä–≤—ã–µ): +5 –æ—á–∫–æ–≤
- –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è –∫–ª—é—á: +2 –æ—á–∫–∞
- –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –º–æ–Ω–µ—Ç–∫–∞ (–≤–ø–µ—Ä–≤—ã–µ): +5 –æ—á–∫–æ–≤
- –ü–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è –º–æ–Ω–µ—Ç–∫–∞: +2 –æ—á–∫–∞
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç–∞–ª: +10 –æ—á–∫–æ–≤

**–®—Ç—Ä–∞—Ñ—ã:**
- –£—Ä–æ–Ω –æ—Ç –≤—Ä–∞–≥–∞ (–±–µ–∑ –∫–ª—é—á–µ–π): -2 –æ—á–∫–∞
- –û—à–∏–±–∫–∞ –≤ –∫–≤–∏–∑–µ –∫–ª—é—á–∞: -3 –æ—á–∫–∞
- –û—à–∏–±–∫–∞ –≤ –∫–≤–∏–∑–µ –º–æ–Ω–µ—Ç–∫–∏: -3 –æ—á–∫–∞
- –û—à–∏–±–∫–∞ –≤ –ø–æ—Ä—Ç–∞–ª–µ: -10 –æ—á–∫–æ–≤
- –ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–π –∫–ª—é—á: -1 –æ—á–∫–æ
- –ü–æ—Ç–µ—Ä—è–Ω–Ω–∞—è –º–æ–Ω–µ—Ç–∫–∞: -1 –æ—á–∫–æ

**‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—á–∫–æ–≤:** –û—á–∫–∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –º–µ–Ω—å—à–µ 0 (–º–∏–Ω–∏–º—É–º)

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `addKeyScore(isUnique)` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –æ—á–∫–∏ –∑–∞ –∫–ª—é—á (—Å —É—á–µ—Ç–æ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏)
- `addCoinScore(isUnique)` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –æ—á–∫–∏ –∑–∞ –º–æ–Ω–µ—Ç–∫—É (—Å —É—á–µ—Ç–æ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏)
- `addPortalScore()` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –æ—á–∫–∏ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç–∞–ª
- `removeScore(amount)` ‚Äî —Å–Ω—è—Ç—å –æ—á–∫–∏ (—à—Ç—Ä–∞—Ñ) —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- `getScore()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –æ—á–∫–∏
- `reset()` ‚Äî —Å–±—Ä–æ—Å–∏—Ç—å –æ—á–∫–∏

### QuizManager

**–ü—É—Ç—å:** `src/game/systems/QuizManager.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏–∑ JSON —Ñ–∞–π–ª–æ–≤.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `loadLevelQuestions(levelNumber)` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–æ–ø—Ä–æ—Å—ã —É—Ä–æ–≤–Ω—è
- `getRandomMiniQuiz()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –º–∏–Ω–∏-–∫–≤–∏–∑ –¥–ª—è –∫–ª—é—á–∞
- `getGlobalQuestion()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å –¥–ª—è –ø–æ—Ä—Ç–∞–ª–æ–≤
- `parseQuestion(questionData)` ‚Äî –ø–∞—Ä—Å–∏—Ç—å –≤–æ–ø—Ä–æ—Å (—Ç–µ–∫—Å—Ç –∏–ª–∏ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º)
- `getWinMessages()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –ø–æ–±–µ–¥–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:**
- `assets/{CURRENT_THEME}/questions/level1.json`

### SpawnSystem

**–ü—É—Ç—å:** `src/game/systems/SpawnSystem.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ —Å–ø–∞–≤–Ω–∞ –æ–±—ä–µ–∫—Ç–æ–≤ (–≤—Ä–∞–≥–∏, –∫–ª—é—á–∏, —Å–µ—Ä–¥–µ—á–∫–∏).

**üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [SPAWN_MATRIX_SYSTEM.md](SPAWN_MATRIX_SYSTEM.md) - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `spawnInitialEnemies()` ‚Äî –Ω–∞—á–∞–ª—å–Ω—ã–π —Å–ø–∞–≤–Ω –≤—Ä–∞–≥–æ–≤
- `spawnEnemy()` ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π —Å–ø–∞–≤–Ω –≤—Ä–∞–≥–∞
- `spawnItems()` ‚Äî –Ω–∞—á–∞–ª—å–Ω—ã–π —Å–ø–∞–≤–Ω –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- `spawnPeriodicItems()` ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π —Å–ø–∞–≤–Ω –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- `getSafePosition(radius)` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –¥–ª—è —Å–ø–∞–≤–Ω–∞

**‚úÖ –ú–∞—Ç—Ä–∏—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `SpawnMatrix` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ —è—á–µ–µ–∫ –∫–∞—Ä—Ç—ã
- –ö–∞—Ä—Ç–∞ 2048√ó2048 —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ —è—á–µ–π–∫–∏ 64√ó64 (–∏—Ç–æ–≥–æ 32√ó32 —è—á–µ–π–∫–∏)
- –¢–∏–ø—ã –∑–∞–Ω—è—Ç–æ—Å—Ç–∏: `'free'`, `'permanent'`, `'item'`, `'enemy'`
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π –æ–±—ä–µ–∫—Ç–æ–≤ –ø—Ä–∏ —Å–ø–∞–≤–Ω–µ
- –í—Ä–∞–≥–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã, –Ω–æ –Ω–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `LevelManager` –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–ø–∞–≤–Ω–∞
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–∞–≤–Ω (–∏–∑–±–µ–≥–∞–µ—Ç –∑–∞–Ω—è—Ç—ã—Ö –∑–æ–Ω)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –æ—Ç –∏–≥—Ä–æ–∫–∞
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –æ—Ç—Å—Ç—É–ø—ã –æ—Ç –∫—Ä–∞–µ–≤ –∫–∞—Ä—Ç—ã:** —É—á–∏—Ç—ã–≤–∞—é—Ç —Ä–∞–∑–º–µ—Ä –æ–±—ä–µ–∫—Ç–∞ (radius)
  - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø: 64 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–∏–∫—Å–µ–ª—è
  - –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–ø–æ—Ä—Ç–∞–ª—ã): –æ—Ç—Å—Ç—É–ø = max(radius, 64)
  - –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –æ–±—ä–µ–∫—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç—ã (0-2048)

### CollisionSystem

**–ü—É—Ç—å:** `src/game/systems/CollisionSystem.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `setupCollisions()` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –∫–æ–ª–ª–∏–∑–∏–π
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤

**–¢–∏–ø—ã –∫–æ–ª–ª–∏–∑–∏–π:**
- **–ò–≥—Ä–æ–∫-–≤—Ä–∞–≥:** Arcade Collider (—Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ).
- **–ò–≥—Ä–æ–∫-–ø—Ä–µ–¥–º–µ—Ç (–¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–π):** Distance-based –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ `update()` —á–µ—Ä–µ–∑ `Phaser.Math.Distance.Between`.
  - –†–∞–¥–∏—É—Å: `ITEM_INTERACTION_RADIUS = 50px`.
  - –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–∞–∑–º–µ—Ä–æ–≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Ç–µ–ª.
- **–ò–≥—Ä–æ–∫-–ø–æ—Ä—Ç–∞–ª/–æ—Ä–∞–∫—É–ª:** Arcade Overlay/Collider (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞ –∫–æ–ª–ª–∏–∑–∏–π).
435: - **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–∂–∏–º–æ–≤:**
436:   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π: Arcade physics Bodies
437:   - Tiled Map: –í–æ–∫—Å–µ–ª—å–Ω–∞—è –∫–æ–ª–ª–∏–∑–∏—è + Sensor Bodies –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ü–∏–∏

### AudioManager

**–ü—É—Ç—å:** `src/game/systems/AudioManager.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–∞–º–∏ –∏ –º—É–∑—ã–∫–æ–π.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `loadAllSounds()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `playBackgroundMusic()` ‚Äî –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏
- `playWinMusic()`, `playGameOverMusic()` ‚Äî –º—É–∑—ã–∫–∞ –ø–æ–±–µ–¥—ã/–ø—Ä–æ–∏–≥—Ä—ã—à–∞
- `playButtonClick()`, `playQuestionSuccess()`, `playQuestionFailure()` ‚Äî –∑–≤—É–∫–∏ UI
- `playPickupLife()`, `playPickupKey()`, `playApplyKey()` ‚Äî –∑–≤—É–∫–∏ –∏–≥—Ä–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π
- `playDamage()`, `playDamageKey()` ‚Äî –∑–≤—É–∫–∏ —É—Ä–æ–Ω–∞
- `playOracleActivated()`, `playPortalActivated()`, `playPortalActivatedComplete()` ‚Äî –∑–≤—É–∫–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- `setMasterVolume(volume)`, `setMusicVolume(volume)`, `setSoundVolume(volume)` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é
- `updateAllVolumes()` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –≤—Å–µ—Ö –∑–≤—É–∫–æ–≤
- `pauseAll()`, `resumeAll()`, `stopMusic()` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –í—Å–µ –∑–≤—É–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `SOUND_KEYS` –∏ `SOUND_VOLUMES` –≤ `gameConstants.ts`
- –¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏: master, music, sound
- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–≤—É–∫–∞
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–≤—É–∫–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- –ü–æ—Ä—Ç–∞–ª—ã –∏–º–µ—é—Ç –¥–≤–∞ –∑–≤—É–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: `PORTAL_ACTIVATED` (–Ω–∞—á–∞–ª–æ) –∏ `PORTAL_ACTIVATED_COMPLETE` (–∫–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞–¥–ø–∏—Å—å –æ—Ç–≤–µ—Ç–∞)
- –ó–≤—É–∫ `damage` –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏ —Å –≤—Ä–∞–≥–∞–º–∏ –Ω–∞ –∫–∞—Ä—Ç–µ, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö

### AnimationManager

**–ü—É—Ç—å:** `src/game/systems/AnimationManager.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø—Ä–∞–π—Ç—à–∏—Ç–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–π.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `loadSpritesheet(config)` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–π—Ç—à–∏—Ç–∞
- `createAnimations(spritesheetKey, animations)` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–π –∏–∑ —Å–ø—Ä–∞–π—Ç—à–∏—Ç–∞
- `generateHorizontalFrames(start, end)` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ø–æ–ª–æ—Å—ã
- `generateVerticalFrames(start, end, cols)` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ –¥–ª—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ø–æ–ª–æ—Å—ã
- `generateGridDirectionFrames(direction, frameCount, cols)` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ –¥–ª—è —Å–µ—Ç–∫–∏ —Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
- `generateGridFrames(startRow, endRow, startCol, endCol, cols)` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π —Å–µ—Ç–∫–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –í—Å–µ —Å–ø—Ä–∞–π—Ç—à–∏—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É—é—Ç—Å—è –≤ `src/config/spritesheetConfigs.ts`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤: HORIZONTAL, VERTICAL, GRID, CUSTOM
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–π

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –í—Å–µ —Å–ø—Ä–∞–π—Ç—à–∏—Ç—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `SPRITESHEET_CONFIGS` (—Å–º. `src/config/spritesheetConfigs.ts`)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª–æ—Å—ã (–∫–ª—é—á–∏, BoyJump), —Å–µ—Ç–∫–∏ 4x4 (–∏–≥—Ä–æ–∫, –≤—Ä–∞–≥–∏)

### SpriteAnimationHandler

**–ü—É—Ç—å:** `src/game/systems/SpriteAnimationHandler.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞–Ω–∏–º–∞—Ü–∏–π –¥–ª—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Å–ø—Ä–∞–π—Ç–æ–≤.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `playDirectionAnimation(velocityX, velocityY)` ‚Äî –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –¥–≤–∏–∂–µ–Ω–∏—è
- `syncFrame()` ‚Äî —Ä—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ (–¥–ª—è physics —Å–ø—Ä–∞–π—Ç–æ–≤)
- `stop()` ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
- `isPlaying()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- `getCurrentAnimation()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∞–Ω–∏–º–∞—Ü–∏–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–≥—Ä–æ–∫–∞ –∏ –≤—Ä–∞–≥–æ–≤ (physics —Å–ø—Ä–∞–π—Ç—ã)
- –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ —á–µ—Ä–µ–∑ —Ç–∞–π–º–µ—Ä (Phaser –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–∞–¥—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è physics —Å–ø—Ä–∞–π—Ç–æ–≤)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ "–º–µ—Ä—Ç–≤–æ–π –∑–æ–Ω—ã" –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –º–µ—Ä—Ü–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- `Player` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SpriteAnimationHandler` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π —Ö–æ–¥—å–±—ã
- `AbstractEnemy` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SpriteAnimationHandler` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π –¥–≤–∏–∂–µ–Ω–∏—è –≤—Ä–∞–≥–æ–≤
- –î–ª—è –æ–±—ã—á–Ω—ã—Ö —Å–ø—Ä–∞–π—Ç–æ–≤ (–Ω–µ physics) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Phaser

---

## Scenes (–°—Ü–µ–Ω—ã)

### BaseScene

**–ü—É—Ç—å:** `src/game/scenes/BaseScene.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–≤—ã—Ö —Å—Ü–µ–Ω.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `initBaseSystems()` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AssetLoader, LevelManager, GameState
- `setupPhysics()` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∏–∑–∏–∫–∏ Arcade
- `setupCamera()` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–º–µ—Ä—ã
- `getCameraWorldSize()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫–∞–º–µ—Ä—ã –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –º–∏—Ä–∞

**–°–≤–æ–π—Å—Ç–≤–∞:**
- `assetLoader: AssetLoader`
- `levelManager: LevelManager`
- `gameState: GameState`

### LoadingScene

**–ü—É—Ç—å:** `src/game/scenes/LoadingScene.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ü–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤.

**‚úÖ –†–ï–§–ê–ö–¢–û–†–ò–ù–ì (v2.4):** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∞—Å—Å–µ—Ç–æ–≤ –¥–ª—è N —É—Ä–æ–≤–Ω–µ–π.

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `preload()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç—É—Ä –∏ —Å–ø—Ä–∞–π—Ç—à–∏—Ç–æ–≤ —á–µ—Ä–µ–∑ `AnimationManager`
- `startLoading()` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ **Dynamic Level Loading Loop:** `for (let i = 1; i <= MAX_LEVELS; i++)` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞—Å—Å–µ—Ç–æ–≤ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π
- ‚úÖ **Dynamic Asset Keys:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `LevelAssetKeys.getMapBgStandard(i)` –∏ `LevelAssetKeys.getLevelConfig(i)`
- ‚úÖ **Level Config Loading:** –ö–æ–Ω—Ñ–∏–≥–∏ —É—Ä–æ–≤–Ω–µ–π –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–∞–∫ JSON –∞—Å—Å–µ—Ç—ã Phaser
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `AnimationManager` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–ø—Ä–∞–π—Ç—à–∏—Ç–æ–≤ –∏–∑ `SPRITESHEET_CONFIGS`
- –í—Å–µ —Å–ø—Ä–∞–π—Ç—à–∏—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ê–Ω–∏–º–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ `MainScene` –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ (–Ω–µ –≤ `LoadingScene`)
- –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ ‚Äî –≤—Å–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

**–ó–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –∞—Å—Å–µ—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è:**
- –§–æ–Ω—ã: `Bg.Base_Standard_LevelN`, `Bg.Base_Tiled_LevelN`, `Bg.Struct_Tiled_LevelN`, `Bg.Overlay_Tiled_LevelN`
- –ö–æ–Ω—Ñ–∏–≥: `levelN_config` (–∏–∑ `configs/levelN.config.json`)

### MainScene (–†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ó–ê–í–ï–†–®–ï–ù ‚úÖ)

**–ü—É—Ç—å:** `src/game/scenes/MainScene.ts`
**–†–∞–∑–º–µ—Ä:** 2665 —Å—Ç—Ä–æ–∫ (–±—ã–ª–æ 4599, —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 42%)
**–î–∞—Ç–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:** 2026-01-19

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è —Å—Ü–µ–Ω–∞ —Å –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π.

**–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
MainScene –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 7 –º–æ–¥—É–ª–µ–π –≤ `src/game/scenes/`:

#### `animation/` (~500 —Å—Ç—Ä–æ–∫ –≤—ã–Ω–µ—Å–µ–Ω–æ)
- **AnimationSyncManager** ‚Äî –µ–¥–∏–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö –∞–Ω–∏–º–∞—Ü–∏–π
- **KeyAnimationSync** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
- **PortalAnimationSync** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—Ä—Ç–∞–ª–æ–≤
- **OracleAnimationSync** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –æ—Ä–∞–∫—É–ª–∞
- **PlayerAnimationSync** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –∏–≥—Ä–æ–∫–∞
- **EnemyAnimationSync** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –≤—Ä–∞–≥–æ–≤

#### `collision/` (~400 —Å—Ç—Ä–æ–∫ –≤—ã–Ω–µ—Å–µ–Ω–æ)
- **EnemyCollisionHandler** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π —Å –≤—Ä–∞–≥–∞–º–∏
- **ItemCollisionHandler** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π —Å –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ (Heart + Key)
- **OracleCollisionHandler** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π —Å –æ—Ä–∞–∫—É–ª–æ–º
- **PortalCollisionHandler** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π —Å –ø–æ—Ä—Ç–∞–ª–∞–º–∏

#### `enemy/` (~300 —Å—Ç—Ä–æ–∫ –≤—ã–Ω–µ—Å–µ–Ω–æ)
- **EnemyManager** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤
- **EnemySpawner** ‚Äî —Å–ø–∞–≤–Ω–µ—Ä –≤—Ä–∞–≥–æ–≤
- **EnemyCloneFactory** ‚Äî —Ñ–∞–±—Ä–∏–∫–∞ –∫–ª–æ–Ω–æ–≤ –≤—Ä–∞–≥–æ–≤

#### `quiz/` (~350 —Å—Ç—Ä–æ–∫ –≤—ã–Ω–µ—Å–µ–Ω–æ)
- **GlobalQuestionManager** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
- **KeyQuizHandler** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–≤–∏–∑–∞ –∫–ª—é—á–µ–π
- **PortalQuizHandler** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–≤–∏–∑–∞ –ø–æ—Ä—Ç–∞–ª–æ–≤

#### `ui/` (~400 —Å—Ç—Ä–æ–∫ –≤—ã–Ω–µ—Å–µ–Ω–æ)
- **HUDManager** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä HUD (—Å–æ–∑–¥–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –ø–æ–∑–∏—Ü–∏—è)
- **CameraManager** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –∫–∞–º–µ—Ä—ã (bounds, follow, resize)
- **EffectsManager** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (floating text, flash)

#### `gameflow/` (~780 —Å—Ç—Ä–æ–∫ –≤—ã–Ω–µ—Å–µ–Ω–æ)
- **EventBusManager** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä —Å–æ–±—ã—Ç–∏–π EventBus
- **GameOverHandler** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ Game Over
- **LevelTransitionHandler** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ —É—Ä–æ–≤–Ω–µ–π

#### `world/` (~350 —Å—Ç—Ä–æ–∫ –≤—ã–Ω–µ—Å–µ–Ω–æ)
- **WorldFactory** ‚Äî —Ñ–∞–±—Ä–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–∏—Ä–∞ (Tiled/Random)
- **EntityFactory** ‚Äî —Ñ–∞–±—Ä–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π (Oracle, Portals, Player)
- **CollisionObjectFactory** ‚Äî —Ñ–∞–±—Ä–∏–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ–ª–ª–∏–∑–∏–∏

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–∏—Å—Ç–µ–º—ã:**
- `Player` –∫–ª–∞—Å—Å (—Å `SpriteAnimationHandler`)
- `AbstractEnemy` –∏ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∏ (—Å `SpriteAnimationHandler`)
- `AbstractPortal` –∏ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∏
- `HealthSystem` –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è
- `ScoreSystem` –¥–ª—è –æ—á–∫–æ–≤
- `QuizManager` –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤
- `AudioManager` –¥–ª—è –≤—Å–µ—Ö –∑–≤—É–∫–æ–≤
- `AnimationManager` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–π
- `KeyQuestionModal`, `PortalModal`, `GameOverModal` ‚Äî –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
- `LevelManager` –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É—Ä–æ–≤–Ω—è
- `SpawnSystem` –¥–ª—è —Å–ø–∞–≤–Ω–∞
- `CollisionSystem` –¥–ª—è –∫–æ–ª–ª–∏–∑–∏–π

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏–π:**
- –°–æ–∑–¥–∞–µ—Ç –≤—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `AnimationManager` –≤ `initializeSystems()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `AnimationSyncManager` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö physics —Å–ø—Ä–∞–π—Ç–æ–≤
- –ò–≥—Ä–æ–∫ –∏ –≤—Ä–∞–≥–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `SpriteAnimationHandler` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–†–µ–∂–∏–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –º–∏—Ä–∞:**
- **Random Spawn (—Å—Ç–∞—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è):** `createGameWorldRandom()` ‚Äî —Å–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞–ª–æ–≤ –∏ –æ—Ä–∞–∫—É–ª–∞
- **Tiled Map (–Ω–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è):** `createGameWorldTiled()` ‚Äî —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ Tiled Map JSON
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ `useTiledMap` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É—Ä–æ–≤–Ω—è
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [TILED_MAP_IMPLEMENTATION.md](TILED_MAP_IMPLEMENTATION.md)

---

## UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Button

**–ü—É—Ç—å:** `src/game/ui/Button.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏.

**–°–æ—Å—Ç–æ—è–Ω–∏—è:** `NORMAL`, `HOVER`, `ACTIVE`, `DISABLED`, `BLINKING`, `WRONG`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω—ã—Ö –∫–ª–∏–∫–æ–≤
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ wordWrap

### QuestionBubble

**–ü—É—Ç—å:** `src/game/ui/QuestionBubble.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–∞–±–±–ª —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤ –û—Ä–∞–∫—É–ª–∞ –∏ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ—Ä—Ç–∞–ª–æ–≤ –≤ –∏–≥—Ä–æ–≤–æ–º –º–∏—Ä–µ.

**–¢–∏–ø—ã –±–∞–±–±–ª–æ–≤:**
- `'oracle'` ‚Äî –¥–ª—è –û—Ä–∞–∫—É–ª–∞ (BubbleMsg.Transparent152x56.png, 152√ó56px, —Ä–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å 134√ó36px)
- `'portal'` ‚Äî –¥–ª—è –ø–æ—Ä—Ç–∞–ª–æ–≤ (BubbleMsg.Transparent136x48.png, 136√ó48px, —Ä–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å 118√ó28px)

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `bubbleSprite` ‚Äî —Å–ø—Ä–∞–π—Ç —Ñ–æ–Ω–∞ –±–∞–±–±–ª–∞ (Depth: 10)
- `questionText` ‚Äî —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞/–æ—Ç–≤–µ—Ç–∞ (Depth: 10, —Å—Ç–∏–ª—å: –∂–∏—Ä–Ω—ã–π, —á–µ—Ä–Ω—ã–π, –±–µ–∑ –æ–±–≤–æ–¥–∫–∏)
- `questionImage` ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ (Depth: 10, –ø—Ä–∞–≤–∞—è —á–∞—Å—Ç—å, 1/4 —à–∏—Ä–∏–Ω—ã)
- `hintText` ‚Äî —Ç–µ–∫—Å—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Depth: 4, —Å—Ç–∏–ª—å: –±–µ–ª—ã–π —Å —á–µ—Ä–Ω–æ–π –æ–±–≤–æ–¥–∫–æ–π)

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞:** —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∞–º–æ–≥–æ –¥–ª–∏–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –≤—Å–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —É—Ä–æ–≤–Ω—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –±–∞–±–±–ª–æ–≤ (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞:** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `calculateOptimalBaseFontSize()` –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ –¥–ª–∏–Ω—É —Ç–µ–∫—Å—Ç–∞
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:** –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—Å—Ç –∑–∞–Ω–∏–º–∞–µ—Ç 3/4 —à–∏—Ä–∏–Ω—ã (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é), –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Äî 1/4 —à–∏—Ä–∏–Ω—ã
- **–ê–Ω–∏–º–∞—Ü–∏–∏:**
  - Fade in/out –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è (300ms, Power2 easing)
  - Ping-pong –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–æ–∫ (75% ‚Üí 25% ‚Üí 75%, 1500ms —Ü–∏–∫–ª, –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ)
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é:** —á–µ—Ä–µ–∑ —Ç–∞–ø/–∫–ª–∏–∫ –ø–æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É –æ–±—ä–µ–∫—Ç—É (Oracle/Portal)
- **–ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –±–∞–±–±–ª–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ–π —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- **Oracle:** –±–∞–±–±–ª —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ `createQuestionBubble()`, —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `setQuestion()`, `toggleQuestionBubble()`, `updateBubblePosition()`
- **Portal:** –±–∞–±–±–ª —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ `createLabels()`, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (`setActivatedState()`), —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (`setBaseState()`)

**Z-–∏–µ—Ä–∞—Ä—Ö–∏—è:**
- –ë–∞–±–±–ª—ã –∏–º–µ—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (Depth: 10), –≤—ã—à–µ –≤—Å–µ—Ö –∏–≥—Ä–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ü–æ–¥—Å–∫–∞–∑–∫–∏ (Depth: 4) –≤—ã—à–µ –∫—É—Å—Ç–æ–≤ –∏ —Ç—Ä–∞–≤—ã, –Ω–æ –Ω–∏–∂–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤, –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏ –≤—Ä–∞–≥–æ–≤

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
- –†–∞–∑–º–µ—Ä—ã: `BUBBLE_SIZES` –≤ `gameConstants.ts`
- –°—Ç–∏–ª–∏ —Ç–µ–∫—Å—Ç–∞: `BUBBLE_QUESTION_*`, `BUBBLE_HINT_*` –≤ `textStyles.ts`
- –°–º–µ—â–µ–Ω–∏—è –ø–æ–¥—Å–∫–∞–∑–æ–∫: `HINT_OFFSETS` –≤ `gameConstants.ts`

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ [BUBBLE_SYSTEM.md](BUBBLE_SYSTEM.md)

### KeyQuestionModal

**–ü—É—Ç—å:** `src/game/ui/KeyQuestionModal.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –ø–æ–¥–Ω—è—Ç–∏–∏ –∫–ª—é—á–µ–π.

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: –º–∏–≥–∞–Ω–∏–µ ‚Üí –≤—Ç–æ—Ä–æ–µ –Ω–∞–∂–∞—Ç–∏–µ ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ + –∫–ª—é—á
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: –º–∏–Ω—É—Å –∂–∏–∑–Ω—å ‚Üí –∫–Ω–æ–ø–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞ ‚Üí wrongFeedback
- –ö—Ä–µ—Å—Ç–∏–∫ ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ –±–µ–∑ –∫–ª—é—á–∞

### PortalModal

**–ü—É—Ç—å:** `src/game/ui/PortalModal.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—Ö–æ–¥–∞ –≤ –ø–æ—Ä—Ç–∞–ª.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –†–∞–∑–º–µ—Ä: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `calculateModalSize()` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ canvas
- Depth: 1000-1002
- Layout: 5 —Ä–∞–≤–Ω—ã—Ö –±–ª–æ–∫–æ–≤ (–≤–æ–ø—Ä–æ—Å, –∫–∞—Ä—Ç–∏–Ω–∫–∞, –æ—Ç–≤–µ—Ç, –∫–Ω–æ–ø–∫–∞ –í–æ–π—Ç–∏, –∫–Ω–æ–ø–∫–∞ –û—Ç–º–µ–Ω–∞)

**–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–≤ —à—Ä–∏—Ñ—Ç–æ–≤:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–¥–∏–Ω—ã–π `baseFontSize` –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–≤–æ–ø—Ä–æ—Å, –æ—Ç–≤–µ—Ç, –∫–Ω–æ–ø–∫–∏)
- `baseFontSize` —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `calculateOptimalBaseFontSize()` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∞–º–æ–≥–æ –¥–ª–∏–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Ä–∞—Å—á–µ—Ç `unifiedFontSize` (–º–∏–Ω–∏–º—É–º –∏–∑ –≤—Å–µ—Ö)
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –µ–¥–∏–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å `1.5` –∫–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–æ–≤ —à—Ä–∏—Ñ—Ç–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤ –æ–∫–Ω–∞—Ö –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ó–≤—É–∫ `damage` –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç–∞–ª (—É—Ä–æ–Ω –Ω–∞–Ω–æ—Å–∏—Ç—Å—è, –Ω–æ –∑–≤—É–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏ —Å –≤—Ä–∞–≥–∞–º–∏)
- –û—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ UI: `scene.time.delayedCall(1, ...)` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ canvas
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π: –∫–Ω–æ–ø–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã —á–µ—Ä–µ–∑ 150–º—Å –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è

### GameOverModal

**–ü—É—Ç—å:** `src/game/ui/GameOverModal.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –†–∞–∑–º–µ—Ä: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `calculateModalSize()` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ canvas
- Depth: 2000-2002
- Layout: 5 —Ä–∞–≤–Ω—ã—Ö –±–ª–æ–∫–æ–≤ (–∑–∞–≥–æ–ª–æ–≤–æ–∫, —Å—á–µ—Ç—á–∏–∫, –ø–µ—Ä—Å–æ–Ω–∞–∂, –∫–Ω–æ–ø–∫–∞ –†–µ—Å—Ç–∞—Ä—Ç, –∫–Ω–æ–ø–∫–∞ "–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å")
- –¢–∏–ø—ã: `WIN_GAME`, `WIN_LEVEL`, `LOSE`

**–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–≤ —à—Ä–∏—Ñ—Ç–æ–≤:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–¥–∏–Ω—ã–π `baseFontSize` –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–∑–∞–≥–æ–ª–æ–≤–æ–∫, —Å—á–µ—Ç—á–∏–∫, –∫–Ω–æ–ø–∫–∏)
- `baseFontSize` —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `calculateOptimalBaseFontSize()` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∞–º–æ–≥–æ –¥–ª–∏–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Ä–∞—Å—á–µ—Ç `unifiedFontSize` (–º–∏–Ω–∏–º—É–º –∏–∑ –≤—Å–µ—Ö)
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –µ–¥–∏–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å `1.5` –∫–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–æ–≤ —à—Ä–∏—Ñ—Ç–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤ –æ–∫–Ω–∞—Ö –ø–æ—Ä—Ç–∞–ª–æ–≤

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–Ω–∏–º–∞—Ü–∏—é `boy_jump_lose` –∏–ª–∏ `boy_jump_win` –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ê–Ω–∏–º–∞—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `AnimationManager` (–Ω–µ —Ö–∞—Ä–¥–∫–æ–¥)
- –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ –≤ `MainScene.update()` (physics —Å–ø—Ä–∞–π—Ç)
- –ü–æ—è–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 1 —Å–µ–∫—É–Ω–¥–∞ –ø–æ—Å–ª–µ —Å–æ–±—ã—Ç–∏—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã, —á—Ç–æ–±—ã —É—Å–ø–µ–ª–∏ –ø—Ä–æ–∏–≥—Ä–∞—Ç—å—Å—è –∑–≤—É–∫–∏ —Å–æ–±—ã—Ç–∏—è
- –û—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ UI: `scene.time.delayedCall(1, ...)` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ canvas
- –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ UI –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞ (–Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –∏–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞)

---

### ‚úÖ v2.0 - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (7 –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ aspect ratio)

**–ü—É—Ç—å:** `src/game/ui/ModalSizeCalculator.ts`, `src/constants/textStyles.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –∏ —à—Ä–∏—Ñ—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤.

**‚úÖ –°–∏—Å—Ç–µ–º–∞ 7 –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ aspect ratio (–≤–º–µ—Å—Ç–æ –±–∏–Ω–∞—Ä–Ω–æ–π portrait/landscape):**

| # | –î–∏–∞–ø–∞–∑–æ–Ω | screenAR | aspectRatio | –ú–Ω–æ–∂–∏—Ç–µ–ª—å —à—Ä–∏—Ñ—Ç–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|----------|-----------|--------------|------------------|----------|
| 1 | Ultra Narrow | 0.25‚Äì0.45 | 0.35 | **1.26** | –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ —É–∑–∫–∏–µ |
| 2 | Extra Narrow | 0.45‚Äì0.6 | 0.525 | **1.34** | –û—á–µ–Ω—å —É–∑–∫–∏–µ (foldable) |
| 3 | Mobile Narrow | 0.6‚Äì0.75 | 0.60 | **1.41** | –£–∑–∫–∏–µ –º–æ–±–∏–ª—å–Ω—ã–µ |
| 4 | Mobile Standard | 0.75‚Äì1.0 | 0.75 | **1.45** | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–æ–±–∏–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—Ä–µ—Ç |
| 5 | Tablet/Square | 1.0‚Äì1.3 | 0.85 | **1.49** | –ü–ª–∞–Ω—à–µ—Ç—ã, –ø–æ—á—Ç–∏ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ |
| 6 | Monitor Small | 1.3‚Äì1.6 | 0.95 | **1.54** | –ù–µ–±–æ–ª—å—à–∏–µ –º–æ–Ω–∏—Ç–æ—Ä—ã |
| 7 | Monitor Large | 1.6+ | 1.0 | **1.54** | –ë–æ–ª—å—à–∏–µ –º–æ–Ω–∏—Ç–æ—Ä—ã |

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. `calculateModalSize()` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–π screenAR (canvasWidth / canvasHeight)
2. –í—ã–±–∏—Ä–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω –∏–∑ 7 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
3. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º aspect ratio
4. `getFontSizeMultiplier()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–Ω–æ–∂–∏—Ç–µ–ª—å –¥–ª—è —à—Ä–∏—Ñ—Ç–∞
5. KeyQuestionModal –∏ CoinBubbleQuiz –ø—Ä–∏–º–µ–Ω—è—é—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å

**–§–æ—Ä–º—É–ª–∞ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞:**
```typescript
const adaptiveMultiplier = getFontSizeMultiplier(screenAR); // 1.26 - 1.54
const finalFontSize = baseFontSize √ó adaptiveMultiplier √ó elementMultiplier;
```

**üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `MODAL_GUIDE.md` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–æ–¥–∞–ª—å–Ω—ã–º –æ–∫–Ω–∞–º
- `FONT_SIZING_SYSTEM.md` ‚Äî —Å–∏—Å—Ç–µ–º–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ —à—Ä–∏—Ñ—Ç–æ–≤

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è React-Phaser

### EventBus

**–ü—É—Ç—å:** `src/game/EventBus.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É React –∏ Phaser.

**–°–æ–±—ã—Ç–∏—è Phaser ‚Üí React:**
- `update-hud` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ HUD (health, keys, altarActive)
- `show-quiz` ‚Äî –ø–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
- `game-over` ‚Äî –æ–∫–æ–Ω—á–∞–Ω–∏–µ –∏–≥—Ä—ã (win/lose)

**–°–æ–±—ã—Ç–∏—è React ‚Üí Phaser:**
- `quiz-completed` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã (correct, context)
- `restart-game` ‚Äî –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```typescript
// Phaser ‚Üí React
EventBus.emit('update-hud', { health: 3, keys: 2, altarActive: false });

// React ‚Üí Phaser
EventBus.emit('quiz-completed', { correct: true, context: 'key' });
```

### PhaserGame –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–ü—É—Ç—å:** `src/react/PhaserGame.tsx`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** React –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è Phaser.Game.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `forwardRef` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Phaser.Game
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç Phaser –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –û—á–∏—â–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

---

## –ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Singleton

- `GameState` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
- `EventBus` ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π

### Factory

- `SpawnSystem` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–æ–≤ –∏ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- `AssetLoader` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

### Strategy

- `AbstractEnemy` –∏ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∏ ‚Äî —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ AI
- `AbstractPortal` –∏ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∏ ‚Äî —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –ø–æ—Ä—Ç–∞–ª–æ–≤

### Observer

- `EventBus` ‚Äî –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è

---

## –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã

```
index.html
  ‚îî‚îÄ> main.tsx
       ‚îî‚îÄ> App.tsx
            ‚îú‚îÄ> PhaserGame.tsx (—Å–æ–∑–¥–∞–µ—Ç Phaser.Game)
            ‚îÇ    ‚îî‚îÄ> LoadingScene (–∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤)
            ‚îÇ         ‚îî‚îÄ> MainScene (–æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ü–µ–Ω–∞)
            ‚îî‚îÄ> UIOverlay (HUD)
```

### –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª

```
MainScene.update()
  ‚îú‚îÄ> Player.update() (–¥–≤–∏–∂–µ–Ω–∏–µ + SpriteAnimationHandler.syncFrame())
  ‚îú‚îÄ> HealthSystem.updatePlayerHealthPosition()
  ‚îú‚îÄ> Enemy.update() (AI –≤—Ä–∞–≥–æ–≤ + SpriteAnimationHandler.syncFrame())
  ‚îú‚îÄ> Camera follow (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ)
  ‚îú‚îÄ> CollisionSystem (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π)
  ‚îú‚îÄ> Key animation sync (—Ä—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ –¥–ª—è –∫–ª—é—á–µ–π)
  ‚îú‚îÄ> BoyJump animation sync (—Ä—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–¥—Ä–æ–≤ –¥–ª—è GameOverModal)
  ‚îî‚îÄ> Key rings rendering
```

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ—Ä—Ç–∞–ª–∞–º–∏

```
handlePortalOverlapEntry(portal)
  ‚îî‚îÄ> showPortalModal(portal)
       ‚îî‚îÄ> PortalModal
            ‚îú‚îÄ> onEnter ‚Üí handlePortalEntry()
            ‚îÇ              ‚îú‚îÄ> isCorrect ‚Üí WIN
            ‚îÇ              ‚îî‚îÄ> !isCorrect ‚Üí LOSE
            ‚îî‚îÄ> onCancel ‚Üí resumeGame()
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TypeScript

### vite-env.d.ts

**–ü—É—Ç—å:** `src/vite-env.d.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** TypeScript —Ç–∏–ø—ã –¥–ª—è Vite environment variables.

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ImportMetaEnv` —Å —Ç–∏–ø–∞–º–∏ –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
  - `VITE_CURRENT_THEME?: string`
  - `VITE_ENABLE_FEEDBACKS?: string`
  - `VITE_ENABLE_WRONG_FEEDBACKS?: string`
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `ImportMeta` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `import.meta.env`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `gameConfig.ts` –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ `import.meta.env`
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ TypeScript –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è Vite

---

## Tiled Map —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π:
1. **Random Spawn** (—Å—Ç–∞—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è) ‚Äî —Å–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
2. **Tiled Map** (–Ω–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è) ‚Äî —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ Tiled Map JSON

### A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ `useTiledMap` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É—Ä–æ–≤–Ω—è:

```json
{
  "levelConfig": {
    "useTiledMap": true,
    "tiledMapKey": "level1_json"
  }
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Tiled Map

Tiled Map JSON —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:
- **Tile Layer "Collision Mask"** ‚Äî –∑–æ–Ω—ã –∫–æ–ª–ª–∏–∑–∏–π (—Å–µ—Ç–∫–∞ 64√ó64 —Ç–∞–π–ª–æ–≤)
- **Object Layer "InteractiveObjects"** ‚Äî –æ–±—ä–µ–∫—Ç—ã Oracle –∏ Portal —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- –ö–æ–ª–ª–∏–∑–∏–∏ –∏–∑ Tiled Map –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è –≤ SpawnMatrix –∫–∞–∫ `'permanent'` —è—á–µ–π–∫–∏
- –ü–æ—Ä—Ç–∞–ª—ã –∏–∑ Tiled Map –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞—Ç–∏—á–Ω—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã (32√ó48 –ø–∏–∫—Å–µ–ª–µ–π)
- –¢—Ä–∏ —Å–ª–æ—è —Ñ–æ–Ω–∞: Base BG, Struct BG, Overlay BG
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∏–∑ Tiled Map –≤ –º–∏—Ä–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã

### –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: [TILED_MAP_IMPLEMENTATION.md](TILED_MAP_IMPLEMENTATION.md)

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [ProjectMap.md](ProjectMap.md) ‚Äî –∫–∞—Ä—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ModularArchitecturePlan.md](ModularArchitecturePlan.md) ‚Äî –ø–ª–∞–Ω –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- [ModularArchitectureProgress.md](ModularArchitectureProgress.md) ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- [TILED_MAP_IMPLEMENTATION.md](TILED_MAP_IMPLEMENTATION.md) ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —É—Ä–æ–≤–Ω–µ–π —Å Tiled Map
- [SPAWN_MATRIX_SYSTEM.md](SPAWN_MATRIX_SYSTEM.md) ‚Äî –º–∞—Ç—Ä–∏—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –í–µ—Ä—Å–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –ê–≤—Ç–æ—Ä |
|------|--------|-----------|-------|
| 2025-01-26 | 1.0 | –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ | AI Assistant |
| 2025-01-27 | 1.1 | –î–æ–±–∞–≤–ª–µ–Ω AnimationManager –∏ SpriteAnimationHandler | AI Assistant |
| 2025-01-27 | 1.1 | –û–±–Ω–æ–≤–ª–µ–Ω AudioManager (–≤—Å–µ –∑–≤—É–∫–∏, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≥—Ä–æ–º–∫–æ—Å—Ç–∏) | AI Assistant |
| 2025-01-27 | 1.1 | –û–±–Ω–æ–≤–ª–µ–Ω LoadingScene (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –±–µ–∑ —Ö–∞—Ä–¥–∫–æ–¥–∞) | AI Assistant |
| 2025-01-27 | 1.1 | –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä—É—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–∞–¥—Ä–æ–≤ | AI Assistant |
| 2025-01-27 | 1.2 | –û–±–Ω–æ–≤–ª–µ–Ω—ã depth –∑–Ω–∞—á–µ–Ω–∏—è: –ø–æ—Ä—Ç–∞–ª `5`, –∏–≥—Ä–æ–∫ `150`, —Å–µ—Ä–¥–µ—á–∫–∏ `160` | AI Assistant |
| 2025-01-27 | 1.3 | –†–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω Z-–ø–æ—Ä—è–¥–æ–∫: —Ñ–æ–Ω(-200/-100) ‚Üí —Ç—Ä–∞–≤–∞(1) ‚Üí —Ç–µ–∫—Å—Ç—ã(2) ‚Üí –∫—É—Å—Ç—ã(3) ‚Üí –ø–æ—Ä—Ç–∞–ª—ã(4) ‚Üí –ø—Ä–µ–¥–º–µ—Ç—ã(5) ‚Üí –ø–µ—Ä—Å–æ–Ω–∞–∂(6) ‚Üí –≤—Ä–∞–≥–∏(7) ‚Üí –æ—Ä–∞–∫—É–ª(8) | AI Assistant |
| 2025-01-27 | 1.2 | –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ–∫—Å—Ç—É—Ä—ã: –ø–æ—Ä—Ç–∞–ª `Portal_64x48.png`, —Å–µ—Ä–¥–µ—á–∫–∏ `Heart5x5.png` | AI Assistant |
| 2025-01-27 | 1.2 | –î–æ–±–∞–≤–ª–µ–Ω –∑–≤—É–∫ `PORTAL_ACTIVATED_COMPLETE` –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ—Ä—Ç–∞–ª–∞ | AI Assistant |
| 2025-01-27 | 1.2 | –û–±–Ω–æ–≤–ª–µ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∑–≤—É–∫ `damage` - —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏ —Å –≤—Ä–∞–≥–∞–º–∏ | AI Assistant |
| 2025-01-27 | 1.2 | –û–±–Ω–æ–≤–ª–µ–Ω —Ä–∞–∑–º–µ—Ä `PortalModal` - —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å `KeyQuestionModal` | AI Assistant |
| 2025-01-27 | 1.2 | –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ 1 —Å–µ–∫—É–Ω–¥–∞ –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º `GameOverModal` | AI Assistant |
| 2025-01-27 | 1.2 | –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ `vite-env.d.ts` –¥–ª—è —Ç–∏–ø–æ–≤ Vite environment variables | AI Assistant |
| 2025-01-27 | 1.3 | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ —à—Ä–∏—Ñ—Ç–æ–≤ –¥–ª—è PortalModal –∏ GameOverModal | AI Assistant |
| 2025-01-27 | 1.3 | –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã (–≤–∫–ª—é—á–∞—è –∫–Ω–æ–ø–∫–∏) –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—ã–π `baseFontSize` –≤ –æ–±–æ–∏—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö | AI Assistant |
| 2025-01-27 | 1.3 | –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –µ–¥–∏–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å `1.5` –∫–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ `unifiedFontSize` | AI Assistant |
| 2025-01-27 | 1.3 | –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–æ–≤ —à—Ä–∏—Ñ—Ç–æ–≤ –≤ –∫–Ω–æ–ø–∫–∞—Ö –ø–æ—Ä—Ç–∞–ª–æ–≤ –∏ –æ–∫–Ω–∞—Ö –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã | AI Assistant |
| 2025-12-08 | 1.7 | –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –º–∞—Ç—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è | AI Assistant |
| 2025-01-XX | 1.8 | –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Tiled Map –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π (A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ), –¥–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª Tiled Map —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è | AI Assistant |
| 2026-02-02 | 2.4 | ‚úÖ **DYNAMIC LEVEL SYSTEM:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã —É—Ä–æ–≤–Ω–µ–π –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ N —É—Ä–æ–≤–Ω–µ–π. LoadingScene –∏—Å–ø–æ–ª—å–∑—É–µ—Ç loop –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞—Å—Å–µ—Ç–æ–≤. LevelManager –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ Cache. WorldFactory –∏—Å–ø–æ–ª—å–∑—É–µ—Ç dynamic keys. MAX_LEVELS = 3. | AI Assistant |

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-XX


### Tiled Map —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

(–°–º. [TILED_MAP_IMPLEMENTATION.md](TILED_MAP_IMPLEMENTATION.md))

---

## –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ (Loading Flow)

### –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (Hybrid Loading)

–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è FCP 1.4s –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:

1.  **Stage 1: Instant UI (React + CSS)**
    *   –ü—Ä–∏ –≤—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ä–∞–∑—É –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ª–µ–≥–∫–∏–π DOM-–æ–≤–µ—Ä–ª–µ–π (`#loading-overlay`).
    *   –°–æ–¥–µ—Ä–∂–∏—Ç CSS-—Å–ø–∏–Ω–Ω–µ—Ä –∏ —Ç–µ–∫—Å—Ç "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...".
    *   –û–≤–µ—Ä–ª–µ–π –≤—à–∏—Ç –≤ `index.html` –∏ —Å—Ç–∞—Ç–∏—á–µ–Ω, —á—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ.

2.  **Stage 2: Deferred Phaser Execution**
    *   –°–∫—Ä–∏–ø—Ç—ã Phaser (`chunk-phaser`) –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–æ–π (`modulePreload: false`).
    *   –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `PhaserGame` –æ—Ç–ª–æ–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ `setTimeout` / `requestIdleCallback` –≤ `App.tsx`.
    *   –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–π –∫–∞–¥—Ä (First Paint) –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–≤–∏–∂–∫–∞.

3.  **Stage 3: LoadingScene (Phaser)**
    *   –ü–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ Phaser –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `LoadingScene`.
    *   –û–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å DOM-–æ–≤–µ—Ä–ª–µ–µ–º, –æ–±–Ω–æ–≤–ª—è—è —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã ("–ó–∞–≥—Ä—É–∑–∫–∞ –∞—Å—Å–µ—Ç–æ–≤...", "–°–æ–∑–¥–∞–Ω–∏–µ –º–∏—Ä–∞...").
    *   –í–∏–∑—É–∞–ª—å–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –æ–¥–∏–Ω –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —Ö–æ—Ç—è –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.

4.  **Stage 4: Cleanup**
    *   –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ (`100%`) `LoadingScene` –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–∞–π–º–µ—Ä (300ms) –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è DOM-–æ–≤–µ—Ä–ª–µ—è.
    *   –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è failsafe-–º–µ—Ö–∞–Ω–∏–∑–º—ã (`try-catch`, –ø—Ä–æ–≤–µ—Ä–∫–∏ `isActive`) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∫—Ä–∞—à–µ–π –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Å—Ü–µ–Ω.

### Optimizations (Production)

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–±–æ—Ä–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
*   **Log Stripping:** –í—Å–µ –≤—ã–∑–æ–≤—ã `console.*` —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `esbuild.drop` (—ç–∫–æ–Ω–æ–º–∏—è CPU/Memory –∏ TBT).
*   **Compression:** –ê—Å—Å–µ—Ç—ã —Å–∂–∏–º–∞—é—Ç—Å—è (gzip) —á–µ—Ä–µ–∑ `vite-plugin-compression`.
*   **Code Splitting:** Phaser –≤—ã–Ω–µ—Å–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —á–∞–Ω–∫, –Ω–æ –µ–≥–æ –∑–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–ª–æ–∂–µ–Ω–∞.
